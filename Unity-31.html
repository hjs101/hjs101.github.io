<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>미니게임 제작 14</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- font, Awesome !-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- syntax.css 추가 -->
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />


    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/custom.css" />

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="기술 블로그 알고리즘 공부 및 프로젝트" />
    <link rel="shortcut icon" href="https://hjs101.github.io/assets/built/images/favicon.png" type="image/png" />
    <link rel="canonical" href="https://hjs101.github.io/Unity-31" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="hjs's Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="미니게임 제작 14" />
    <meta property="og:description" content="앞으로는 간단한 게임들을 만들어보며 추가적인 기능에 대해 공부를 해보려한다. 간단한 것부터 만들기 시작하여 만든 결과물을 레퍼런스 하여 덩치를 조금씩 키워나가는 과정을 밟아보자. 지식이 많지 않아 부족할 수 있지만, 하는데까지 해보겠다. 현재 구상 하고 있는 것은 예전에 잠깐 화제가 되었던 모바일 게임 매직 서바이벌 과 스팀에서 최근 붐이 일었던 게임 뱀파이어" />
    <meta property="og:url" content="https://hjs101.github.io/Unity-31" />
    <meta property="og:image" content="https://hjs101.github.io/assets/built/images/Unity-logo.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2022-04-14T09:00:00+09:00" />
    <meta property="article:modified_time" content="2022-04-14T09:00:00+09:00" />
    <meta property="article:tag" content="Unity" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="미니게임 제작 14" />
    <meta name="twitter:description" content="앞으로는 간단한 게임들을 만들어보며 추가적인 기능에 대해 공부를 해보려한다. 간단한 것부터 만들기 시작하여 만든 결과물을 레퍼런스 하여 덩치를 조금씩 키워나가는 과정을 밟아보자. 지식이 많지 않아 부족할 수 있지만, 하는데까지 해보겠다. 현재 구상 하고 있는 것은 예전에 잠깐 화제가 되었던 모바일 게임 매직 서바이벌 과 스팀에서 최근 붐이 일었던 게임 뱀파이어" />
    <meta name="twitter:url" content="https://hjs101.github.io/" />
    <meta name="twitter:image" content="https://hjs101.github.io/assets/built/images/Unity-logo.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="hjs's Blog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Unity" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "hjs's Blog",
        "logo": "https://hjs101.github.io/"
    },
    "url": "https://hjs101.github.io/Unity-31",
    "image": {
        "@type": "ImageObject",
        "url": "https://hjs101.github.io/assets/built/images/Unity-logo.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://hjs101.github.io/Unity-31"
    },
    "description": "앞으로는 간단한 게임들을 만들어보며 추가적인 기능에 대해 공부를 해보려한다. 간단한 것부터 만들기 시작하여 만든 결과물을 레퍼런스 하여 덩치를 조금씩 키워나가는 과정을 밟아보자. 지식이 많지 않아 부족할 수 있지만, 하는데까지 해보겠다. 현재 구상 하고 있는 것은 예전에 잠깐 화제가 되었던 모바일 게임 매직 서바이벌 과 스팀에서 최근 붐이 일었던 게임 뱀파이어"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="미니게임 제작 14" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://hjs101.github.io/">hjs's Blog</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-jekyll" role="menuitem"><a href="/boj-menu">BOJ</a></li>
    <li class="nav-python" role="menuitem"><a href="/swea-menu">SWEA</a></li>
    <!-- <li class="nav-python" role="menuitem"><a href="/Dragon-menu">Dragon</a></li> -->
    <li class="nav-python" role="menuitem"><a href="/Unity-menu">Unity</a></li>
        <li class="nav-about" role="menuitem"><a href="/FrontEnd-menu">FrontEnd</a></li>
    <li class="nav-archive" role="menuitem">
        <a href="/archive.html">All Posts</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/author_archive.html">Tag별 Posts</a>
    </li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-unity post tag-Unity ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="14 April 2022">14 April 2022</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/unity/'>UNITY</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">미니게임 제작 14</h1>
            </header>
            <!--
            
            <figure class="post-full-image" style="background-image: url(/assets/built/images/Unity-logo.png)">
            </figure>
             !-->

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p>앞으로는 간단한 게임들을 만들어보며 추가적인 기능에 대해 공부를 해보려한다. 간단한 것부터 만들기 시작하여 만든 결과물을 레퍼런스 하여 덩치를 조금씩 키워나가는 과정을 밟아보자. 지식이 많지 않아 부족할 수 있지만, 하는데까지 해보겠다.</p>

<p>현재 구상 하고 있는 것은 예전에 잠깐 화제가 되었던 모바일 게임 <strong><em>매직 서바이벌</em></strong> 과 스팀에서 최근 붐이 일었던 게임 <strong><em>뱀파이어 서바이벌</em></strong> 의 장르를 본딴 생존 서바이벌 슈팅 게임이다.</p>

<p>이번에는 플레이어가 이동함에 따라서 맵 타일을 이동시켜 무한 맵을 구현해보겠다.</p>

<p>일단 코드를 먼저 보자.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">BgScrolling</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">GameObject</span><span class="p">[]</span> <span class="n">tmp_tile</span><span class="p">;</span> <span class="c1">//임시 타일 public으로 받기</span>
    <span class="k">public</span> <span class="n">GameObject</span><span class="p">[,]</span> <span class="n">tile</span><span class="p">;</span> <span class="c1">//임시 타일을 3x3으로 바꿀 변수</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">currentIndex_i</span><span class="p">;</span> <span class="c1">//현재 나의 타일 인덱스 i</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">currentIndex_j</span><span class="p">;</span> <span class="c1">//현재 나의 타일 인덱스 j</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="n">tmpStringIndex</span><span class="p">;</span> <span class="c1">//오브젝트 이름(ex. 00 ~ 22)로 받을 변수</span>


    <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">tile</span> <span class="p">=</span> <span class="k">new</span> <span class="n">GameObject</span><span class="p">[</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">];</span> <span class="c1">// 3x3</span>
        <span class="kt">int</span> <span class="n">cnt</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">3</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="m">3</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="p">=</span> <span class="n">tmp_tile</span><span class="p">[</span><span class="n">cnt</span><span class="p">];</span> <span class="c1">//타일을 2차원으로 변경</span>
                <span class="n">cnt</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">tmpStringIndex</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">;</span> <span class="c1">//오브젝트 이름을 스트링으로 받아서 인덱스에 넣음</span>
        <span class="n">currentIndex_i</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">tmpStringIndex</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="nf">ToString</span><span class="p">());</span>
        <span class="n">currentIndex_j</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">tmpStringIndex</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="nf">ToString</span><span class="p">());</span>
    <span class="p">}</span>


    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnTriggerExit2D</span><span class="p">(</span><span class="n">Collider2D</span> <span class="n">other</span><span class="p">)</span> <span class="c1">//충돌 Exit처리 -&gt; 나가면 배경이 바뀌어야 함</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">tag</span> <span class="p">!=</span> <span class="s">"Player"</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span> <span class="c1">//다른 충돌이면 그냥 리턴</span>

        <span class="n">Vector3</span> <span class="n">dir</span> <span class="p">=</span> <span class="n">other</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">;</span> <span class="c1">//플레이어의 위치 - 타일의 중심 =&gt;&gt;&gt; 타일 중심에서의 벡터가 나옴</span>
        <span class="kt">float</span> <span class="n">angle</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="nf">Angle</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">up</span><span class="p">,</span> <span class="n">dir</span><span class="p">);</span> <span class="c1">//각도</span>
        <span class="kt">int</span> <span class="n">sign</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="nf">Cross</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">up</span><span class="p">,</span> <span class="n">dir</span><span class="p">).</span><span class="n">z</span> <span class="p">&lt;</span> <span class="m">0</span> <span class="p">?</span> <span class="p">-</span><span class="m">1</span> <span class="p">:</span> <span class="m">1</span><span class="p">;</span>
        <span class="n">angle</span> <span class="p">*=</span> <span class="n">sign</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(-</span><span class="m">45</span> <span class="p">&lt;=</span> <span class="n">angle</span> <span class="p">&amp;&amp;</span> <span class="n">angle</span> <span class="p">&lt;=</span> <span class="m">45</span><span class="p">)</span> <span class="c1">// 위쪽</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">3</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="c1">// 타일 3개를 옮겨야 함</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">currentIndex_i</span> <span class="p">+</span> <span class="m">1</span> <span class="p">&lt;=</span> <span class="m">2</span><span class="p">)</span> <span class="c1">// 배열에 대한 예외처리, 아래의 else문은 currentIndex_i가 2일때임</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">tile</span><span class="p">[</span><span class="n">currentIndex_i</span> <span class="p">+</span> <span class="m">1</span><span class="p">,</span> <span class="n">i</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">==</span> <span class="p">-</span><span class="m">16</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">tile</span><span class="p">[</span><span class="n">currentIndex_i</span> <span class="p">+</span> <span class="m">1</span><span class="p">,</span> <span class="n">i</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">16</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span> <span class="c1">//위쪽으로 가므로 아래행을 옮김</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">tile</span><span class="p">[</span><span class="m">0</span><span class="p">,</span> <span class="n">i</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">==</span> <span class="p">-</span><span class="m">16</span><span class="p">)</span> <span class="c1">//currentIndex_i가 2일때는 아래가 0인덱스</span>
                    <span class="p">{</span>
                        <span class="n">tile</span><span class="p">[</span><span class="m">0</span><span class="p">,</span> <span class="n">i</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">16</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="m">45</span> <span class="p">&lt;=</span> <span class="n">angle</span> <span class="p">&amp;&amp;</span> <span class="n">angle</span> <span class="p">&lt;=</span> <span class="m">135</span><span class="p">)</span> <span class="c1">// 왼쪽</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">3</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">currentIndex_j</span> <span class="p">+</span> <span class="m">1</span> <span class="p">&lt;=</span> <span class="m">2</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">currentIndex_j</span> <span class="p">+</span> <span class="m">1</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">==</span> <span class="m">17</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">currentIndex_j</span> <span class="p">+</span> <span class="m">1</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(-</span><span class="m">17</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">0</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">==</span> <span class="m">17</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">0</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(-</span><span class="m">17</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="m">135</span> <span class="p">&lt;=</span> <span class="n">angle</span> <span class="p">||</span> <span class="p">-</span><span class="m">135</span> <span class="p">&gt;=</span> <span class="n">angle</span><span class="p">)</span> <span class="c1">// 아래쪽 -135 ~ -180 or 135 ~ 180</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">3</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">currentIndex_i</span> <span class="p">-</span> <span class="m">1</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">tile</span><span class="p">[</span><span class="n">currentIndex_i</span> <span class="p">-</span> <span class="m">1</span><span class="p">,</span> <span class="n">i</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">==</span> <span class="m">16</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">tile</span><span class="p">[</span><span class="n">currentIndex_i</span> <span class="p">-</span> <span class="m">1</span><span class="p">,</span> <span class="n">i</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="p">-</span><span class="m">16</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">tile</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="n">i</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">y</span> <span class="p">==</span> <span class="m">16</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">tile</span><span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="n">i</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="p">-</span><span class="m">16</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(-</span><span class="m">135</span> <span class="p">&lt;=</span> <span class="n">angle</span> <span class="p">&amp;&amp;</span> <span class="n">angle</span> <span class="p">&lt;=</span> <span class="p">-</span><span class="m">45</span><span class="p">)</span> <span class="c1">// 오른쪽</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">3</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">currentIndex_j</span> <span class="p">-</span> <span class="m">1</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">currentIndex_j</span> <span class="p">-</span> <span class="m">1</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">==</span> <span class="p">-</span><span class="m">17</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">currentIndex_j</span> <span class="p">-</span> <span class="m">1</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">17</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">2</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span><span class="p">.</span><span class="n">x</span> <span class="p">==</span> <span class="p">-</span><span class="m">17</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">tile</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="m">2</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">+=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">17</span> <span class="p">*</span> <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><a href="https://malbongcode.tistory.com/18?category=856315">코드 출처</a></p>

<p>횡스크롤 배경을 무한 스크롤링 하는 것은 간단했지만, 탑뷰를 기준으로 무한 맵을 만드는 방법은 아무리 고민해봐도 생각이 나지 않았다. 따라서 구글링을 통해 방법을 찾아보았고, 위 링크에 있는 코드를 내 프로젝트에 맞게 변형하여 사용하였다.</p>

<p>요점은 다음과 같다. 전체 Map 타일을 3*3으로 나눈다. 각각의 나뉘어진 타일은 Collider2D 컴포넌트를 가지고 있고, isTrigger가 체크되어 있다.</p>

<p>각각의 OnTriggerExit2D 메서드를 통해 현재 타일에서 벗어났을 경우, 그 각도를 체크한다.</p>

<p>각도에 따라서 아래, 위, 오른쪽, 왼쪽 타일을 이동시킨다.</p>

<p>영상으로 보면 어떻게 이루어지는 지 더 잘 보일 것이다.</p>

<p><img src="https://hjs101.github.io/assets/images/game01_103.gif" alt="game_103" /></p>

<p>위 Gif 파일을 통해서 보면, 플레이어가 이동하는 방향에 따라 9분할된 Map 타일이 당겨지는 모습을 볼 수 있다.</p>

<p><img src="https://hjs101.github.io/assets/images/game01_104.gif" alt="game_104" /></p>

<p>게임 화면에선 다음과 같이 나타난다. 이유를 모르겠지만, 오른쪽에 분명히 타일 맵이 깔려 있는데도 위 그림처럼 로딩이 되지 않아 빈 공간이 나타나는 모습이다. 이것 저것 해결 방법을 시도했지만 아직 해결하지 못한 상태다.</p>

<p>약간 석연찮은 점은 있지만, 무한 맵을 마지막으로 이번 실습에서 구현하고 싶었던 부분은 모두 구현완료 했다.</p>

<p>다음에는 지금까지 어떤 내용을 구현했는지 정리해보겠다.</p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!--
            
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to hjs's Blog</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

                </section>
            
            !-->
            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/built/images/author-logo.png" alt="hjs" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/hjs">hjs</a></h4>
                                
                                    <p>Read <a href="/author/hjs">more posts</a> by this author.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/hjs">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            var this_page_url = 'https://hjs101.github.io/Unity-31';
                            var this_page_identifier = '/Unity-31';
                            var this_page_title = '미니게임 제작 14';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://xxxxxxxx.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/built/images/blog-cover1.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; hjs's Blog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/unity/">Unity</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/Unity-30">미니게임 제작 13</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/Unity-29">미니게임 제작 12</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/Unity-28">미니게임 제작 11</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/unity/">
                                
                                    See all 31 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/Unity-30">
                <div class="post-card-image" style="background-image: url(/assets/built/images/Unity-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/Unity-30">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Unity</span>
                            
                        
                    

                    <h2 class="post-card-title">미니게임 제작 13</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>앞으로는 간단한 게임들을 만들어보며 추가적인 기능에 대해 공부를 해보려한다. 간단한 것부터 만들기 시작하여 만든 결과물을 레퍼런스 하여 덩치를 조금씩 키워나가는 과정을 밟아보자. 지식이 많지 않아 부족할 수 있지만, 하는데까지 해보겠다.

</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/author-logo.png" alt="hjs" />
                        
                        <span class="post-card-author">
                            <a href="/author/hjs/">hjs</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://hjs101.github.io/">
            
            <span>hjs's Blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">미니게임 제작 14</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%EB%AF%B8%EB%8B%88%EA%B2%8C%EC%9E%84+%EC%A0%9C%EC%9E%91+14&amp;url=https://hjs101.github.ioUnity-31"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://hjs101.github.ioUnity-31"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://hjs101.github.io/">hjs's Blog</a> &copy; 2022</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Subscribe to hjs's Blog</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-xxxxxxxx-x', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
